## 魔云腾主机手动配置网络参数

**场景描述：**
    魔云腾主机除了通过DHCP获取IP信息之外，是否有其他方式手动设置主机的网络信息，比如IP地址、网关、DNS等；

答：魔云腾主机支持手动设置固定IP和其他网络参数，步骤如下

**-----------------------配置部分---------------------**
:::tip
请严格按流程配置每一步，否则重启完会出现无法连接盒子
:::

**1、通过SSH登陆主机（默认账号密码：`user`/`myt`）**

**2、进入特权模式（`su`），默认特权密码：`myt`**

**3、检查系统版本，输入以下命令查看（当前教程根据当前版本调试）**

```
uname -a
```

在输出结果中，时间为2023年11月(Nov)7号：

```
Linux myt-os-pro 5.10.160 #7 SMP PREEMPT Tue Nov 7 16:00:55 CST 2023 aarch64 Linux
```

![img](/img/wlcs1.png)



**4、编辑网络配置文件（复制粘贴即可，根据下面代码修改）**

```
vi /etc/network/interfaces
```



**5、编辑文件内容，内容如下**

```
auto eth0
iface eth0 inet static
  address 10.168.0.232    #主机ip
  netmask 255.255.255.0  #掩码
  gateway 10.168.0.1     #主机网关
```

示例

![img](/img/wlcs2.png)




**6、保存退出**

按键盘Esc键，在下方出现符号“：”时，输入：wq 回车即可

**7、编辑开机启动脚本启用当前网卡配置**

```
vi /etc/rc.conf
```

将光标移动到第二行，按键盘“i” 建进入编辑模式，输入以下内容保存退出

```
ifup eth0
```

按键盘Esc键，在下方出现符号“：”时，输入：wq 回车即可

示例

![img](/img/wlcs3.png)



**8、重启主机验证是否生效，输入以下命名重启主机（云机也会随之重启）**

```
reboot
```

---------------验证部分---------------

**9、等待30秒重新SSH登陆主机，输入以下内容查看是否生效**

```
ip route | grep default
```

在输出的界面第一行：

```
default via x.x.x.x dev eth0 metric 1 onlink
#x.x.x.x出现你设置的网关表示生效
```

示例

![img](/img/wlcs4.png)



**10、验证IP地址方法，输入以下命令查看是否生效**

```
ip add | grep eth0
```

在输出的第二行：

```
inet x.x.x.x/24 scope global eth0
#x.x.x.x出现你设置的ip表示生效
```

示例

![img](/img/wlcs5.png)



--------------DNS修改部分-------------

**1、dns文件修改之后是及时生效，无需重启，编辑以下配置文件**

```
vi /etc/resolv.conf
```

在文本框中按键盘`i`键盘进入编辑模式，按键盘上下左右键移动编辑位置，找到第二行`nameserver x.x.x.x`， 将dns修改成自定义ip，保留第一行和第二行，删除其他所有行保存退出即可

保存退出方法：

按键盘`Esc`键，在下方出现符号“：”时，输入：wq 回车即可

删除内容按键盘`Backspace`

```
#vi /etc/resolv.conf 配置文件内容示例

# Generated by NetworkManager
nameserver 223.5.5.5
```

示例

![img](/img/wlcs6.png)



**---------------恢复初始配置-----------------**

**1、通过ssh登陆主机（方法参照上面流程）**

**2、删除以下配置文件，输入下面命令回车**

```
rm -rf /etc/network/interfaces
```

**3、输入下面命令重启主机将恢复初始设置，并通过dhcp自动获取ip**

```
reboot
```



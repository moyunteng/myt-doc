---
slug: /android/zbtl
---
## 通用直播推流教程

- [多路直播]是魔云腾研发出来的适合主播多平台直播，24小时直播的解决方案，在不同云手机上安装不同的直播平台，不同的云手机可以同时拉取到同一个直播源，从而实现多平台同时直播，您也可以事先录制好直播视频,通过OBS将流推给云手机实现24小时滚动直播；
- 目前直播模式支持2大模型：第一种通过PC端OBS软件将本地多媒体源推至云机平台进行直播，多媒体源可包括：本地音视频文件、PC端摄像头、麦克风、等媒体源；
- 第二种是通过调用真实手机的摄像头，将摄像头采集的音视频流推送至云机平台进行直播
- 声明：魔云腾仅提供多路直播功能，请严格遵循中华人民共和国法律法规行为，同时用户需要仔细了解各大平台的直播规范以免违规。任何使用本功能造成的后果由使用者个人承担，必要情况下我司将竭力配合网监部门协助调查



#### 指导配置资料

- 该配置资料包含2套windows平台下直播所需的软件，本教程使用windows 11系统、魔云腾C1系类盒子及下方所提供的软件版本做为演示，软件及版本如下：

  | 软件运行平台         | 软件名称                        | 软件版本 version  | 内容介绍                                                 |
  | -------------------- | ------------------------------- | ----------------- | -------------------------------------------------------- |
  | win7 / win10 / win11 | 魔云腾 Zeus                     | myt_zeus_20230713 | 魔云腾云机控制端，云机预览和接收媒体流                   |
  | win7 / win10 / win11 | Open Broadcaster Software (OBS) | 29.1.3 (64bit)    | PC端媒体推流，将本地音视频流推至视频流服务器进行协议转换 |
  | win7 / win10 / win11 | Simple Realtime Server (SRS)    | 6.0               | 媒体流服务器，用于接收媒体源和发送媒体源                 |
  | Android / iOS        | 腾讯视频云-RTMP推流             | -                 | 将手机摄像头媒体源推送至多媒体服务器SRS                  |
  | 魔云腾Android镜像    | MYTOS-12-x-V19 (专业版)         | >=V19             | 运行第三方直播app及拉取多媒体源                          |



### 1 调用本地媒体源直播方案

##### 1.1 认识调用本地媒体源直播方案

- 调用本地媒体源是利用电脑的OBS软件采集电脑本地的多媒体源进行直播、本地的媒体源可以包括，本地录制好的视频文件，电脑桌面、连接电脑的外置摄像头、语音等媒体源，OBS软件通过RTMP、RTC协议将本地媒体源推送到电脑的SRS多媒体流服务器进行格式转换，然后通过魔云腾的云机直播功能将多媒体源的图像、声音拉取到云机中使用，最后云机通过第三方直播app进行直播，直播的音视频画面跟电脑上采集的音视频一直，最终互联网的用户可以实时观看采集的直播内容；

- 方案示意图

  ![本地媒体源1](/img/android/本地媒体源1.png)

### 2 本地组网

##### 2.1 直播环境准备

- 直播环境准备分为3个部分，第1部分为本地的网络环境、第2部分为相关直播软件的安装、第3部分为直播相关配置向导；本教程将通过windows 11系统作为演示，魔云腾C1系类盒子



2.2 设备组网连接示意图

| 设备                         | 设备IP地址              |
| ---------------------------- | ----------------------- |
| 无线路由器、WiFi（信号:MYT） | LAN 口：192.168.10.1    |
| 魔云腾盒子                   | RJ45 口：192.168.10.11  |
| 安卓手机、苹果手机1部        | WiFi地址：192.168.10.12 |
| 电脑1台 （windows11）        | 网线：192.168.10.13     |



![本地媒体源2](/img/android/本地媒体源2.png)

##### 2.3 本地网络环境及基础设施配置检查

###### **路由器配置向导**

- 本案例使用了一台无线路由器，路由器的wan口通过PPPOE拨号获取IP，路由器的LAN口IP配置为：192.168.10.1，配置了一个WIFI，wifi信号为：MYT；同时路由器的2个lan口分别通过网线连接了1台电脑和一台魔云腾盒子，真实手机通过wifi连接了无线MYT；

- 

- 无线路由器的配置如下图所示：

- ![路由器wan配置](/img/android/路由器wan配置.png)

- ![路由器lan配置](/img/android/路由器lan配置.png)

- 无线WiFI配置如下：

  ![无线wifi配置](/img/android/无线wifi配置.png)

- 提示：这里的WIFi名称MYT可以自己定义，如果改变了后面设备连接wifi的时候选择自己定义的wifi名称即可



###### **魔云腾盒子连接向导**

- 魔云腾盒子首先通过网线连接盒子标识有RJ45字样的网口，这个网口通过网线与上面路由器的LAN口相连，连接之后连接盒子的电源即可，盒子总共有2条线，一条电源线和一条网线，通电之后盒子的2给状态灯亮了表示正常，盒子连接示意图如下：

  ![魔云腾盒子线路连接](/img/android/魔云腾盒子线路连接.png)

###### **电脑连接网络向导**

- 电脑可以是台式机/笔记本，这里以台式机为准，并且通过网线连接至路由器的LAN，电脑的网络配置通过DHCP自动获取即可，本示例电脑获取到的ip地址如图所示：

  ![电脑ip配置1](/img/android/电脑ip配置1.png)

  提示：windows电脑查看ip方法：

- 同时按下win键+R，出现运行对话框之后输入cmd，之后按回车键，在弹出黑色界面中输入ipconfig，然后按回车键即可，这里每个人看到的ip地址可能不一样，以看到的为准，并且记录好这个ip地址，这个IP只要不是169.254开头的即可，否则网络配置或者连接有问题！

- 故障排查

- 电脑如果通过上面的方法连接之后，无法正常上网，请按下列步骤排查

- 1、检查路由器的网线是否跟电脑连接好，如果调整过路由器的配置，尝试重启电脑重新获IP

- 2、按上述查看电脑的IP地址，看是否与预期设置的一致，比如路由器的LAN口是192.168.10.x，通过ipconfig方法查看IP如果发现不是192.168.10.x开头的，请检查电脑是否连接正确的路由器(可能一个环境里有多个路由器)

- 提示：电脑、笔记本也可以通过wifi连接，但是连接wifi之后电脑所获取到的ip要与有线的保持一致，比如有线获取到的ip地址是192.168.10.x开头，连接wifi之后获取到的ip也应该是192.168.10.x开头，这个x可以不一样（实际IP地址以自己配置的为准）



###### **魔云腾控制软件安装向导**

- 为了验证盒子是否正常连接成功以及为后续的配置准备工作，这里先在电脑上把魔云腾盒子控制软件安装好，这里以windows 11系统安装为例，安装软件及系统版本如下：

| 软件名称   | 版本              | 下载地址                                                     |
| ---------- | ----------------- | ------------------------------------------------------------ |
| 魔云腾Zeus | myt_zeus_20230713 | [下载 - 武汉魔云腾科技有限公司](https://doc.moyunteng.com/xia-zai) |
| windows 11 | 22H2 22621.1992   | 无                                                           |

- 下载好软件之后，双击运行软件按提示安装
- ![魔云腾app下载-2](/img/android/魔云腾app下载-2.png)
- 在正常的安装过程中，期间不会有任何提示错误，如果有弹窗报错，则取消重新安装，或者检查是否已经安装
  安装完成之后，可以双击运行，也可以右键通过“以管理员身份运行”，如果出现部分功能无法使用，请右键通过管理员身份运行尝试
- ![魔云腾app下载-4](/img/android/魔云腾app下载-4.png)
- 运行之后，如果第一使用没有账号，点击右下角的“注册”按钮，按提示注册之后再次登陆
- ![魔云腾app下载-5-vbog](/img/android/魔云腾app下载-5-vbog.png)
- 登陆成功之后，如果魔云腾的盒子连接正常，左侧窗口至少会有一个以“192.168.10.x”开头的ip出现，如果部署环境跟教程一样，这边会以192.168.10.x开头，路由器的配置和接线没有按教程配置的，以自己看到的为准；这里演示案例中显示的ip是192.168.10.11，如图所示：
- ![魔云腾app下载-6.png](/img/android/魔云腾app下载-6.png)
- **到这一步，基础准备环境已经准备好，如果打开客户端之后右边的菜单中没有显示任何IP，请按以下步骤排查**
- **故障排查：**
- 1、检查魔云腾盒子的网线、电源线是否连接正常，再次尝试拔掉电源重新插上电源；
- 2、检查电脑和魔云腾盒子的网线是否连接在同一个路由器下，如果电脑是通过wifi连接，则这个wifi是否在同一个路由器下；
- 3、检查电脑的防火墙是否全部关闭，如果是开启状态，请按下列步骤关闭防火墙
- 按一下键盘的win键弹窗搜索对话框，输入cmd，在最佳匹配下面出来一个“命令提示符”，右键鼠标已管理员身份运行，在弹出的黑色界面复制下面代码回车执行，操作如图所示：
- ![win键.png](/img/android/win键.png)
- 在弹窗的搜索对话框输入字母：cmd
- ![cmd窗口.png](/img/android/cmd窗口.png)
- 复制如下代码，右键粘贴到黑色对话框回车执行

```
#关闭防火墙
NetSh Advfirewall set allprofiles state off
```

- ![关闭windows防火墙.png](/img/android/关闭windows防火墙.png)
- 执行完成之后可以通过下面代码来检查防火墙是否关闭成功（可选）

```
#检查防火墙状态
netsh advfirewall show allprofiles
```

![检查防火墙.png](/img/android/检查防火墙.png)

4、检查电脑是否存在其他网卡，请按以下步骤排查，除本地网卡和wifi网卡之外，其他的网卡右键鼠标选择禁用；

同时按下键盘的win+R键，在弹窗的运行对话框中复制如下代码，点击“确定”执行

![检查网卡命令.png](/img/android/检查网卡命令.png)

除了本地网卡和wifi，右键鼠标“禁用”其他网卡

![禁用网卡.png](/img/android/禁用网卡.png)

5、完成上述检查和操作之后，重新打开魔云腾Zeus客户端，正常情况下就会搜索到IP地址，如果依然发现，联系魔云腾客服协助处理



### 3 多媒体服务软件安装及配置

##### 3.1 多媒体服务软件SRS及OBS安装方法

提示：SRS和OBS软件可以分别安装在不同的电脑上，这里为了方便演示，SRS和OBS服务软件都安装在一台电脑上

下载windows版本的SRS多媒体服务软件，软件下载地址如下：

| 运行平台                     | 软件名称                          | 软件版本        | 下载地址                                                     |
| ---------------------------- | --------------------------------- | --------------- | ------------------------------------------------------------ |
| windows 7、10、11 (64位平台) | Simple Realtime Server （SRS）    | version：6.0    | [SRS-Windows-x86_64-6.0.exe](http://doc.moyunteng.com/upload/SRS-Windows-x86_64-6.0.exe) |
| windows 7、10、11 (64位平台) | Open Broadcaster Software （OBS） | version：29.1.3 | [OBS-29.1.3-x64.exe](http://doc.moyunteng.com/upload/OBS-29.1.3-x64.exe) |



**SRS服务软件安装步骤**

###### 1、在windows系统上双击运行刚才下载的[SRS-Windows-x86_64-6.0.exe](http://doc.moyunteng.com/upload/SRS-Windows-x86_64-6.0.exe)软件，按提示点击Next

###### ![srs安装1.png](/img/android/srs安装1.png)

###### 2、点击 “I Agree”，下一步

###### ![srs安装2.png](/img/android/srs安装2.png)

###### 3、保持默认安装路径，点击“Install”进行安装

###### ![srs安装3.png](/img/android/srs安装3.png)

###### 4、最后点击“Finish”，完成安装，之后桌面会多出来一个SRS图标的

###### ![srs安装4.png](/img/android/srs安装4.png)

###### 5、右键桌面刚才安装的SRS图标，以管理员身份运行

###### ![srs安装5.png](/img/android/srs安装5.png)

###### 6、运行之后会弹窗一个黑色对话框，这个对话框可以最小化，但不要关闭，同时如果仔细查看输出的内容，会看到一个ip地址，这个ip就是电脑的IP，如图所示表示已完成安装和正常运行，记录自己看到的IP，后面配置手机的时候会用到

##### **![srs安装6.png](/img/android/srs安装6.png)**

##### **3.2 OBS服务软件安装步骤**

下载windows版本的OBS多媒体服务软件，软件下载地址如下：

| 运行平台                     | 软件名称                          | 软件版本        | 下载地址                                                     |
| ---------------------------- | --------------------------------- | --------------- | ------------------------------------------------------------ |
| windows 7、10、11 (64位平台) | Open Broadcaster Software （OBS） | version：29.1.3 | [OBS-29.1.3-x64.exe](http://doc.moyunteng.com/upload/OBS-29.1.3-x64.exe) |



1、在windows系统上双击运行刚才下载的[OBS-29.1.3-x64.exe](http://doc.moyunteng.com/upload/OBS-29.1.3-x64.exe)软件，按提示Next进行安装

![obs安装1.png](/img/android/obs安装1.png)

###### 2、一路点击Next之后，保持默认安装路径，点击Install进行安装，此过程根据电脑性能可能需要等待1分钟左右

![obs安装2.png](/img/android/obs安装2.png)

###### 3、在完成安装之后，取消默认勾选的选项，点击Finish完成安装，之后桌面会多出来一个OBS Studio的图标

![obs安装3.png](/img/android/obs安装3.png)

###### 4、完成安装之后，右键刚才安装的OBS软件，选择“以管理员身份运行”

![obs安装4.png](/img/android/obs安装4.png)

###### 5、第一次运行软件会弹出自动配置向导，如果对OBS的配置不太熟悉，直接点击“取消”按钮

![obs安装5.png](/img/android/obs安装5.png)

##### **3.3 开始配置OBS采集媒体源进行推流**

在配置OSB推流时，先准备一个直播视频素材，这里以一个60秒倒计时的视频作为演示；

提示：除了直播视频文件，可以将电脑的外置摄像头、音频、等多媒体素材进行直播，具体查看OBS的官方手册

| 媒体文件类型 | 文件名称   | 下载地址                                                     |
| ------------ | ---------- | ------------------------------------------------------------ |
| MP4          | 60秒倒计时 | [60秒到计时.mp4](http://doc.moyunteng.com/upload/60秒倒计时.mp4) |

1、在OBS的设置里添加一个媒体源，以刚才的60秒倒计时视频作为素材添加

![obs安装6.png](/img/android/obs安装6.png)

2、选择媒体源，这个媒体源的内容就是直播的内容

![obs安装7.png](/img/android/obs安装7.png)

3、给新媒体源命名，名称格式没有要求，这里以文件名称作为命名

![obs安装8.png](/img/android/obs安装8.png)

4、浏览视频文件位置，添加60秒的视频文件，同时将“循环”勾选上

![obs安装9.png](/img/android/obs安装9.png)

5、视频文件添加成功之后，上方窗口会持续播放视频内容，如果看到如下图的效果，表示一个媒体源添加完成

![obs安装10.png](/img/android/obs安装10.png)

##### **3.4 OBS推流设置**

在添加完媒体源之后，接下来开始配置OBS的推流，将视频内容通过RTMP、RTC协议推送到SRS服务器

1、点击OBS上的“设置”按钮，按下图提示依次操作，其中服务器一栏的配置可选RTMP和RTC，配置示例如下

| 推流协议类型 | 填写示例                    | 协议对比效果                                      |
| ------------ | --------------------------- | ------------------------------------------------- |
| webrtc       | webrtc://192.168.10.12/live | webrtc采用udp协议封装传输，直播画面延迟低【推荐】 |
| rtmp         | rtmp://192.168.10.12/live   | rtmp采用tcp协议封装传输，直播画面延迟略高         |

![obs安装11.png](/img/android/obs安装11.png)

2、完成推流设置之后，点击“开始直播”进入推流

![obs安装14.png](/img/android/obs安装14.png)

![obs安装13.png](/img/android/obs安装13.png)

###### **故障排查**

如果点击【开始直播】弹出“无法连接到服务器”，请按下列步骤排查

1、检查上一章节安装的SRS软件是否已经启动（纯黑色界面那个软件）

2、检查“设置”-“直播”配置中，服务器一栏的配置参数，其中IP 192.168.10.12这个地址是否替换成自己电脑的，同时其他参数是否一致（每个字母区分大小写）

3、检查电脑的防火墙是否关闭



### 4 魔云腾云机配置直播功能

推流配置完成之后，现在开始配置魔云腾的云机直播功能，此步骤是将SRS服务器的媒体源通过RTC协议拉取到云机中

1 新建一个云机窗口，安卓镜像需要>=V19版本以上，这里演示新建一个1004号窗口，镜像选择V20作为演示

![魔云腾直播配置1.png](/img/android/魔云腾直播配置1.png)



2、创建成功之后，等待15秒之后，开始操作刚才新建的T1004号云机，点击右侧的“...”，点击"设置推流"

![魔云腾直播配置2.png](/img/android/魔云腾直播配置2.png)

3、在弹出的设置窗口中，推流类型选择：”rtc流“，推流地址填写：webrtc://192.168.10.12/live/123，最后点击“确定”

其中”192.168.10.12“需要替换成自己SRS的服务ip地址，也就是电脑的IP，其他参数保持不变

这里的设置可选2种类型：RTMP和RTC，配置示例和解释如下

| 推流协议类型 | 填写示例                    | 协议对比效果                                      |
| ------------ | --------------------------- | ------------------------------------------------- |
| webrtc       | webrtc://192.168.10.12/live | webrtc采用udp协议封装传输，直播画面延迟低【推荐】 |
| rtmp         | rtmp://192.168.10.12/live   | rtmp采用tcp协议封装传输，直播画面延迟略高         |

```
#推流地址----将192.168.10.12替换自己的IP
webrtc://192.168.10.12/live/123
rtmp://192.168.10.12/live/123
```

![魔云腾直播配置3.png](/img/android/魔云腾直播配置3.png)

4、设置完成之后，点击”启动“按钮进入云机窗口，点击桌面的相机即可看到刚才设置的60秒到计时视频内容，后续可以通过第三方直播app进行直播，只要直播app用到云机的摄像头，就会把设置的媒体源(60秒到计时视频)显示给互联网观看用户，用户通过直播app看到的画面跟直播的内容一致

![obs安装15.png](/img/android/obs安装15.png)

5、左侧是魔云腾云手机摄像头输出的内容，与右侧OBS采集的视频内容一致表示配置成功，后面自行开启第三方App直播即可（根据电脑和网络的性能，云手机接收直播内容有1-5秒的延迟）

![obs安装16.png](/img/android/obs安装16.png)

故障排查：

如果按上述方法配置完成之后，也没有报错，但是无法预览直播内容时，请按下列步骤排查问题

1、检查OBS的配置和云机的推流设置参数是否一致

2、检查SRS服务软件是否启动（黑色界面那个软件）

3、检查云机镜像版本是否大于或等于V19版本

4、尝试停止OBS直播，在开启直播，以及重新设置云机的推流

5、重启魔云腾云机

6、测试魔云腾云机相机是否正常可用，测试方法如下

- 选择需要测试的云机，设置推流，填写互联网公共测试直播地址，测试地址如下：
- 提示：此测试地址无需电脑开启obs和srs软件，只是单纯测试云机的相机是否可用，不涉及一整套直播流程

```
#推流类型可选：rtc流，或者rtmp流
http://devimages.apple.com.edgekey.net/streaming/examples/bipbop_4x3/gear2/prog_index.m3u8
```

![obs安装17.png](/img/android/obs安装17.png)![obs安装18.png](/img/android/obs安装18.png)
